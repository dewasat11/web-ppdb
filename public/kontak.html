<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="csrf-token" content="{{CSRF_TOKEN}}" />
  <meta name="description" content="Kontak Resmi PPDSB Pondok Pesantren Al Ikhsan Beji - Hubungi kami untuk informasi pendaftaran, biaya, atau kehidupan santri." data-i18n="meta.description.contact" data-i18n-attr="content" data-i18n-skip-text />
  <meta name="keywords" content="Kontak, Pondok Pesantren Al Ikhsan Beji, PPDSB, Beji, Depok, pendaftaran santri" />

  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="/favicon.png" sizes="32x32">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">

  <title data-i18n="meta.title.contact">Kontak â€“ PPDSB Pondok Pesantren Al Ikhsan Beji</title>

  <script src="/i18n.js" defer></script>

  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Optional: Tailwind config tweak
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#ecfdf5',
              100: '#d1fae5',
              200: '#a7f3d0',
              300: '#6ee7b7',
              400: '#34d399',
              500: '#10b981', // emerald
              600: '#059669',
              700: '#047857',
              800: '#065f46',
              900: '#064e3b',
            }
          }
        }
      }
    }
  </script>

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />

  <!-- Choices.js / Flatpickr / Toastify (opsional, kompatibel dgn snippet lama) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --tw-font-sans: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
    }
    html, body { font-family: var(--tw-font-sans); }
    [x-cloak] { display: none !important; }

    /* ===== RESPONSIVE ENHANCEMENTS ===== */
    
    /* Mobile-first responsive typography */
    @media (max-width: 640px) {
      h1 { font-size: 1.875rem !important; line-height: 2.25rem !important; }
      h2 { font-size: 1.5rem !important; line-height: 2rem !important; }
      h3 { font-size: 1.25rem !important; line-height: 1.75rem !important; }
      .text-lg { font-size: 1rem !important; line-height: 1.5rem !important; }
      .text-xl { font-size: 1.125rem !important; line-height: 1.75rem !important; }
    }

    /* Navbar responsive improvements */
    @media (max-width: 768px) {
      .navbar-brand span {
        font-size: 0.875rem !important;
        max-width: 200px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
    }

    /* Hero section responsive */
    @media (max-width: 640px) {
      .hero-content {
        padding: 2rem 1rem !important;
      }
    }

    /* Gelombang cards responsive stacking */
    @media (max-width: 768px) {
      #gelombangContainer {
        grid-template-columns: 1fr !important;
      }
    }

    /* WhatsApp widget responsive */
    @media (max-width: 640px) {
      .whatsapp-widget {
        padding: 0.75rem 1rem !important;
        font-size: 0.875rem !important;
      }
      .whatsapp-widget .flex-col span:first-child {
        font-size: 0.75rem !important;
      }
      .whatsapp-widget .flex-col span:last-child {
        font-size: 0.625rem !important;
      }
    }

    /* Card hover effects - disable on touch devices */
    @media (hover: none) {
      .hover\:-translate-y-2:hover {
        transform: none !important;
      }
    }

    /* Smooth transitions */
    * {
      -webkit-tap-highlight-color: transparent;
    }

    /* Improve button touch targets on mobile */
    @media (max-width: 640px) {
      a, button {
        min-height: 44px;
        min-width: 44px;
      }
    }

    /* Container responsive padding */
    @media (max-width: 640px) {
      .container {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
      }
    }

    /* Mobile menu improvements */
    @media (max-width: 768px) {
      .mobile-menu {
        max-width: 280px;
        width: 85vw;
      }
    }

    #yellowBlob {
      will-change: transform;
      transition: transform 0.2s ease-out;
    }

    @supports (animation-timeline: scroll()) {
      #yellowBlob[data-css-parallax="true"] {
        animation: yellowBlobParallax linear both;
        animation-timeline: scroll();
        animation-range: 0 40vh;
      }

      @keyframes yellowBlobParallax {
        from {
          transform: translate3d(0, 0, 0);
        }
        to {
          transform: translate3d(0, -120px, 0);
        }
      }
    }
  </style>

  <!-- Alpine.js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body class="min-h-screen flex flex-col bg-white text-gray-800">

<!-- HEADER -->
  <header class="relative z-50">
    <div id="superHeader" class="relative h-16 md:h-20 overflow-hidden">
      <div
        id="yellowBlob"
        class="absolute inset-x-0 -top-6 h-[120%] bg-yellow-400/90 opacity-95 blur-xl rounded-b-[3rem] pointer-events-none transform-gpu"
        aria-hidden="true"
      ></div>
      <div class="relative flex h-full items-end">
        <div class="max-w-7xl mx-auto flex w-full items-end justify-end gap-6 px-4 pb-3 sm:px-6 lg:px-8 text-xs font-semibold tracking-wide text-yellow-950">
          <div class="flex items-center gap-2">
            <span class="uppercase">Bahasa:</span>
            <button
              type="button"
              data-setlang="id"
              class="inline-flex h-8 w-8 items-center justify-center rounded-full border border-yellow-500 bg-yellow-200 text-base shadow-sm transition hover:bg-yellow-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-yellow-700"
              aria-label="Bahasa Indonesia"
              data-i18n="nav.language.id"
              data-i18n-attr="aria-label"
              data-i18n-skip-text
            >
              <span aria-hidden="true">ðŸ‡®ðŸ‡©</span>
            </button>
          </div>
          <div class="flex items-center gap-2">
            <span class="uppercase">Language:</span>
            <button
              type="button"
              data-setlang="en"
              class="inline-flex h-8 w-8 items-center justify-center rounded-full border border-yellow-500 bg-yellow-200 text-base shadow-sm transition hover:bg-yellow-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-yellow-700"
              aria-label="English"
              data-i18n="nav.language.en"
              data-i18n-attr="aria-label"
              data-i18n-skip-text
            >
              <span aria-hidden="true">ðŸ‡¬ðŸ‡§</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- NAVBAR -->
  <nav class="sticky top-0 z-40 bg-white/95 backdrop-blur supports-backdrop-blur:bg-white/85 shadow-lg" x-data="{ mobileMenuOpen: false, profileDropdownOpen: false }">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <!-- Logo -->
        <div class="flex-shrink-0 flex items-center">
          <a href="/" class="flex items-center">
            <img src="/assets/img/logo-alikhsan.png" class="h-16 w-auto" alt="Logo Pondok Pesantren Al Ikhsan Beji" />
          </a>
        </div>

        <!-- Desktop Navigation -->
        <div class="hidden md:block">
          <div class="flex items-baseline space-x-4">
            <a href="/" class="text-gray-600 hover:text-brand-600 px-3 py-2 rounded-md text-sm font-medium transition" data-i18n="nav.home">Beranda</a>

            <!-- Dropdown Informasi -->
            <div class="relative">
              <button @click="profileDropdownOpen=!profileDropdownOpen" class="text-gray-600 hover:text-brand-600 px-3 py-2 rounded-md text-sm font-medium flex items-center gap-1 transition">
                <span data-i18n="nav.info">Informasi</span>
                <i class="bi bi-caret-down-fill text-xs transition-transform" :class="{'rotate-180': profileDropdownOpen}"></i>
              </button>
              <div x-cloak x-show="profileDropdownOpen" @click.outside="profileDropdownOpen=false" x-transition class="absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-2 z-50 border border-gray-100">
                <a href="/alur-pendaftaran.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50" data-i18n="nav.flow">Alur Pendaftaran</a>
                <a href="/syarat-pendaftaran.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50" data-i18n="nav.requirements">Syarat Pendaftaran</a>
                <a href="/biaya.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50" data-i18n="nav.fees">Biaya</a>
              </div>
            </div>

            <a href="/brosur.html" class="text-gray-600 hover:text-brand-600 px-3 py-2 rounded-md text-sm font-medium transition" data-i18n="nav.brochure">Brosur</a>
            <a href="/kontak.html" aria-current="page" class="px-3 py-2 rounded-md text-sm font-semibold text-brand-700 bg-brand-50 hover:bg-brand-100 transition" data-i18n="nav.contact">Kontak</a>
          </div>
        </div>

        <!-- CTA Button Desktop -->
        <div class="hidden md:block">
          <a href="/login" class="bg-brand-700 hover:bg-brand-800 text-white px-6 py-2 rounded-lg text-sm font-medium shadow-md hover:shadow-lg transition" data-i18n="nav.admin">Admin</a>
        </div>

        <!-- Mobile menu button -->
        <div class="md:hidden">
          <button @click="mobileMenuOpen=!mobileMenuOpen" class="inline-flex items-center justify-center p-2 rounded-md text-gray-600 hover:text-brand-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-brand-500 transition">
            <i class="bi" :class="mobileMenuOpen ? 'bi-x-lg' : 'bi-list'"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile Backdrop -->
    <div x-cloak x-show="mobileMenuOpen" @click="mobileMenuOpen=false" class="md:hidden fixed inset-0 z-40 bg-black/50"></div>

    <!-- Mobile Menu -->
    <div x-cloak x-show="mobileMenuOpen" x-transition class="md:hidden fixed inset-y-0 left-0 z-50 mobile-menu bg-white shadow-xl border-r border-gray-200 overflow-y-auto">
      <div class="flex items-center justify-between p-4 border-b border-gray-200">
        <div class="flex items-center">
          <img src="/assets/img/logo-alikhsan.png" class="h-16 w-auto" alt="Logo Pondok Pesantren Al Ikhsan Beji" />
        </div>
        <button @click="mobileMenuOpen=false" class="p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition"><i class="bi bi-x-lg"></i></button>
      </div>

      <div class="px-2 pt-4 pb-3 space-y-1">
        <a href="/" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-brand-700 hover:bg-gray-50 transition" data-i18n="nav.home">Beranda</a>

        <details class="px-1">
          <summary class="cursor-pointer text-gray-700 hover:text-brand-700 hover:bg-gray-50 px-3 py-2 rounded-md text-base font-medium transition" data-i18n="nav.info">Informasi</summary>
          <div class="pl-6 space-y-1 mt-2">
            <a href="/alur-pendaftaran.html" class="block px-3 py-2 text-sm rounded-md hover:bg-gray-50" data-i18n="nav.flow">Alur Pendaftaran</a>
            <a href="/syarat-pendaftaran.html" class="block px-3 py-2 text-sm rounded-md hover:bg-gray-50" data-i18n="nav.requirements">Syarat Pendaftaran</a>
            <a href="/biaya.html" class="block px-3 py-2 text-sm rounded-md hover:bg-gray-50" data-i18n="nav.fees">Biaya</a>
          </div>
        </details>

        <a href="/brosur.html" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-50 transition" data-i18n="nav.brochure">Brosur</a>
        <a href="/kontak.html" aria-current="page" class="block px-3 py-2 rounded-md text-base font-semibold bg-brand-50 text-brand-700" data-i18n="nav.contact">Kontak</a>

        <div class="pt-4 pb-2 px-2">
          <a href="/login.html" class="w-full bg-brand-700 hover:bg-brand-800 text-white px-4 py-3 rounded-lg text-base font-medium shadow-md hover:shadow-lg block text-center transition" data-i18n="nav.admin">Admin</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="flex-1 container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-6" data-i18n="pages.contact.heading">Kontak Kami</h1>
    <div class="prose max-w-none">
      <p class="mb-4" data-i18n="pages.contact.intro">Untuk informasi lebih lanjut mengenai Pondok Pesantren Al Ikhsan Beji, silakan hubungi kami melalui saluran berikut:</p>
      <div id="kontakCards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <div class="bg-brand-50 p-6 rounded-lg shadow-md text-center text-gray-500" data-i18n="pages.contact.loading">Memuat data kontak...</div>
      </div>

      <h2 class="text-2xl font-bold text-gray-900 mb-4" data-i18n="pages.contact.locationHeading">Lokasi Kami</h2>
      <div class="aspect-w-16 aspect-h-9 w-full rounded-lg overflow-hidden shadow-lg border border-gray-200">
        <iframe id="kontakMapFrame" src="" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
      <p class="mt-2 text-sm text-gray-500" id="kontakMapInfo"></p>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="bg-white text-gray-600 py-6 shadow-2xl border-t border-gray-200 mt-auto">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <p class="text-sm"><span data-i18n="footer.copyright">Â© 2025 Pondok Pesantren Al Ikhsan Beji. All rights reserved.</span> <span class="hidden sm:inline" data-i18n="footer.credit">Development by Tim IT Pesantren</span></p>
    </div>
  </footer>

  <!-- Vendors JS (optional) -->
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script>
    // Shim toastr -> toastify agar kompatibel dgn snippet lama
    window.toastr = {
      success(msg){ Toastify({ text: msg, duration: 4000, close: true, gravity: 'top', position: 'right', style: { background: '#10b981', color: '#fff' }}).showToast(); },
      error(msg){ Toastify({ text: msg, duration: 4000, close: true, gravity: 'top', position: 'right', style: { background: '#ef4444', color: '#fff' }}).showToast(); },
      warning(msg){ Toastify({ text: msg, duration: 4000, close: true, gravity: 'top', position: 'right', style: { background: '#f59e0b', color: '#fff' }}).showToast(); },
      info(msg){ Toastify({ text: msg, duration: 4000, close: true, gravity: 'top', position: 'right', style: { background: '#3b82f6', color: '#fff' }}).showToast(); }
    }
  </script>

  <script>
    (function() {
      const escapeHtml = (value = "") =>
        String(value)
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      const escapeAttribute = escapeHtml;

      const translate = (key, fallback = "", replacements) => {
        if (typeof window.__ === "function") {
          const value = window.__(key, replacements);
          if (typeof value === "string" && value !== key) {
            return value;
          }
        }
        return fallback || key;
      };

      const getActiveLanguage = () => {
        if (typeof window.__lang === "function") {
          return window.__lang();
        }
        const stored = (localStorage.getItem("lang") || "id").toLowerCase();
        return stored.startsWith("en") ? "en" : "id";
      };

      const selectKontakField = (item = {}, field, lang) => {
        const normalized = lang === "en" ? "en" : "id";
        if (normalized === "en") {
          const value = item[`${field}_en`];
          if (typeof value === "string" && value.trim()) return value.trim();
        }
        const base = item[field];
        if (typeof base === "string" && base.trim()) return base.trim();
        if (normalized === "id") {
          const fallback = item[`${field}_en`];
          if (typeof fallback === "string" && fallback.trim()) return fallback.trim();
        } else {
          const fallback = item[field];
          if (typeof fallback === "string" && fallback.trim()) return fallback.trim();
        }
        return "";
      };

      const typeLabelMap = {
        info: { id: "Info lainnya", en: "Information" },
        whatsapp: { id: "WhatsApp", en: "WhatsApp" },
        email: { id: "Email", en: "Email" },
        address: { id: "Alamat", en: "Address" },
        phone: { id: "Telepon", en: "Phone" },
        website: { id: "Website", en: "Website" },
      };

      let cachedKontakItems = null;

      function buildKontakCard(item, index, lang) {
        const iconClass =
          item.icon_class && item.icon_class.trim()
            ? item.icon_class.trim()
            : "bi bi-info-circle";
        const title = escapeHtml(selectKontakField(item, "title", lang));
        const value = escapeHtml(selectKontakField(item, "value", lang));
        const link = item.link_url ? item.link_url.trim() : "";
        const delay = 150 + index * 100;
        const typeKey = item.item_type || "info";
        const typeConfig = typeLabelMap[typeKey];
        const typeLabel = typeConfig
          ? escapeHtml(typeConfig[lang.startsWith("en") ? "en" : "id"]) 
          : escapeHtml(typeKey);

        const valueMarkup = link
          ? `<a href="${escapeAttribute(link)}" target="_blank" rel="noopener" class="text-brand-600 hover:underline">${value}</a>`
          : `<p class="text-gray-700">${value}</p>`;

        return `
          <div class="bg-brand-50 p-6 rounded-lg shadow-md text-center" data-aos="fade-up" data-aos-delay="${delay}">
            <i class="${iconClass} text-4xl text-brand-700 mb-3"></i>
            <h3 class="text-xl font-semibold text-gray-800 mb-1">${title}</h3>
            ${typeLabel ? `<p class="text-xs uppercase tracking-wide text-brand-600 mb-2">${typeLabel}</p>` : ""}
            ${valueMarkup}
          </div>
        `;
      }

      function renderKontakCards(items) {
        const container = document.getElementById("kontakCards");
        if (!container) return;

        if (!items || !items.length) {
          const emptyText = escapeHtml(translate("pages.contact.empty", "Kontak belum tersedia."));
          container.innerHTML = `<div class="bg-brand-50 p-6 rounded-lg shadow-md text-center text-gray-500">${emptyText}</div>`;
          return;
        }

        const lang = getActiveLanguage();
        container.innerHTML = items
          .map((item, index) => buildKontakCard(item, index, lang))
          .join("");
      }

      async function loadKontakCards({ force = false } = {}) {
        if (!force && cachedKontakItems) {
          renderKontakCards(cachedKontakItems);
          return;
        }

        const container = document.getElementById("kontakCards");
        if (!container) return;

        const loadingText = escapeHtml(translate("pages.contact.loading", "Memuat data kontak..."));
        container.innerHTML = `<div class="bg-brand-50 p-6 rounded-lg shadow-md text-center text-gray-500">${loadingText}</div>`;

        try {
          const response = await fetch("/api/kontak_items");
          const result = await response.json();
          if (!result.ok) {
            throw new Error(result.error || "Gagal memuat data");
          }

          const items = Array.isArray(result.data) ? result.data : [];
          cachedKontakItems = items
            .map((item) => ({
              ...item,
              title: selectKontakField(item, "title", "id"),
              title_en: selectKontakField(item, "title", "en"),
              value: selectKontakField(item, "value", "id"),
              value_en: selectKontakField(item, "value", "en"),
            }))
            .sort(
              (a, b) =>
                (a?.order_index || 0) - (b?.order_index || 0)
            );

          if (!cachedKontakItems.length) {
            const emptyText = escapeHtml(translate("pages.contact.empty", "Kontak belum tersedia."));
            container.innerHTML = `<div class="bg-brand-50 p-6 rounded-lg shadow-md text-center text-gray-500">${emptyText}</div>`;
            return;
          }

          renderKontakCards(cachedKontakItems);
        } catch (error) {
          console.error("[KONTAK_PAGE] Error memuat kontak:", error);
          const errorText = escapeHtml(translate("pages.contact.error", "Gagal memuat kontak."));
          container.innerHTML = `<div class="bg-red-50 p-6 rounded-lg shadow-md text-center text-red-600">${errorText}</div>`;
        }
      }

      async function loadKontakMap() {
        const frame = document.getElementById("kontakMapFrame");
        const infoEl = document.getElementById("kontakMapInfo");
        if (!frame) return;

        if (infoEl) infoEl.textContent = translate("pages.contact.map.loading", "Memuat peta lokasi...");

        try {
          const response = await fetch("/api/kontak_settings");
          const result = await response.json();
          if (!result.ok) {
            throw new Error(result.error || "Gagal memuat pengaturan peta");
          }

          const mapUrl = result.data?.map_embed_url;
          if (mapUrl) {
            frame.src = mapUrl;
            if (infoEl) infoEl.textContent = "";
          } else {
            frame.removeAttribute("src");
            if (infoEl) infoEl.textContent = translate("pages.contact.map.empty", "Lokasi belum tersedia.");
          }
        } catch (error) {
          console.error("[KONTAK_PAGE] Error memuat peta:", error);
          frame.removeAttribute("src");
          if (infoEl) infoEl.textContent = translate("pages.contact.map.error", "Gagal memuat peta lokasi.");
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        loadKontakCards({ force: true });
        loadKontakMap();
      });

      window.addEventListener("i18n:languageChanged", () => {
        if (cachedKontakItems) {
          renderKontakCards(cachedKontakItems);
        } else {
          loadKontakCards({ force: true });
        }
      });

      window.addEventListener("storage", (event) => {
        if (event.key === "kontak_items_update") {
          cachedKontakItems = null;
          loadKontakCards({ force: true });
        }
      });
    })();
  </script>

  

  <!-- AOS JS -->
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>
    AOS.init({ duration: 800, once: true });
  </script>
  <script>
    (function() {
      const blob = document.getElementById("yellowBlob");
      if (!blob) return;

      const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)");
      const supportsScrollTimeline =
        typeof CSS !== "undefined" && typeof CSS.supports === "function" && CSS.supports("animation-timeline: scroll()");

      if (supportsScrollTimeline) {
        blob.dataset.cssParallax = "true";
        return;
      }

      if (prefersReducedMotion.matches) {
        blob.style.transform = "translate3d(0, 0, 0)";
        return;
      }

      const k = 0.6;
      let latestY = window.scrollY || 0;
      let ticking = false;

      const clamp = (value, min, max) => Math.min(Math.max(value, min), max);

      const applyParallax = () => {
        const offset = clamp(-latestY * k, -80, 0);
        blob.style.transform = `translate3d(0, ${offset}px, 0)`;
        ticking = false;
      };

      const onScroll = () => {
        latestY = window.scrollY || 0;
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(applyParallax);
        }
      };

      window.addEventListener("scroll", onScroll, { passive: true });
      applyParallax();

      const handleMotionChange = (event) => {
        if (event.matches) {
          window.removeEventListener("scroll", onScroll);
          blob.style.transform = "translate3d(0, 0, 0)";
        } else {
          window.addEventListener("scroll", onScroll, { passive: true });
          applyParallax();
        }
      };

      if (typeof prefersReducedMotion.addEventListener === "function") {
        prefersReducedMotion.addEventListener("change", handleMotionChange);
      } else if (typeof prefersReducedMotion.addListener === "function") {
        prefersReducedMotion.addListener(handleMotionChange);
      }
    })();
  </script>

  <!-- AOS JS -->
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>
    AOS.init({ duration: 800, once: true });
  </script>
</body>
</html>
